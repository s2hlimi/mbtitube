<html>
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>MBTItube</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">

  <link href="https://fonts.googleapis.com/css2?family=Black+Han+Sans&family=Jua&display=swap" rel="stylesheet">

</head>

<link rel="stylesheet" href="../static/style.css">

<script>
  $(document).ready(function () {
                get_posts()
            })


  function myAccFunc() {
    var x = document.getElementById("demoAcc");
    if (x.className.indexOf("w3-show") == -1) {
      x.className += " w3-show";
      x.previousElementSibling.className += " w3-green";
    } else {
      x.className = x.className.replace(" w3-show", "");
      x.previousElementSibling.className =
              x.previousElementSibling.className.replace(" w3-green", "");
    }
  }

  function num2str(count) {
    if (count > 10000) {
      return parseInt(count / 1000) + "k"
    }
    if (count > 500) {
      return parseInt(count / 100) / 10 + "k"
    }
    if (count == 0) {
      return ""
    }
    return count
  }


  function toggle_like(post_id, type) {
    console.log(post_id, type)
    let $a_like = $(`#${post_id} a[aria-label='${type}']`)
    let $i_like = $a_like.find("i")
    let class_s = {"heart": "fa-heart"}
    let class_o = {"heart": "fa-heart-o"}
    if ($i_like.hasClass(class_s[type])) {
        $.ajax({
            type: "POST",
            url: "/update_like",
            data: {
                post_id_give: post_id,
                type_give: type,
                action_give: "unlike"
            },
            success: function (response) {
                console.log("unlike")
                $i_like.addClass(class_o[type]).removeClass(class_s[type])
                $a_like.find("span.like-num").text(num2str(response["count"]))
            }
        })
    } else {
        $.ajax({
            type: "POST",
            url: "/update_like",
            data: {
                post_id_give: post_id,
                type_give: type,
                action_give: "like"
            },
            success: function (response) {
                console.log("like")
                $i_like.addClass(class_s[type]).removeClass(class_o[type])
                $a_like.find("span.like-num").text(num2str(response["count"]))
            }
        })

    }
}

</script>

<body>
<div class="w3-sidebar w3-bar-block w3-light-grey w3-card" style="width:200px;"><br>
  <a href="#" class="w3-bar-item w3-button"><img src="../static/mbti.png"  width="150", height="50"></a><br>
  <a href="/user" class="w3-bar-item w3-button">나의 페이지</a>
  <button class="w3-button w3-block w3-left-align" onclick="myAccFunc()">
    MBTI 타입 선택하기 <i class="fa fa-caret-down"></i>
  </button>
  <div id="demoAcc" class="w3-hide w3-white w3-card">
    <a href="#" class="w3-bar-item w3-button">분석가형<br>(INTJ/INTP/ENTJ/ENTP)</a>
    <a href="#" class="w3-bar-item w3-button">외교관형<br>(INFJ/INFP/ENFJ/ENFP)</a>
    <a href="#" class="w3-bar-item w3-button">관리자형<br>(ISTJ/ISFJ/ESTJ/ESFJ)</a>
    <a href="#" class="w3-bar-item w3-button">탐험가형<br>(ISTP/ISFP/ESTP/ESFP)</a>
  </div><br><br><br>

  <a href="#" class="w3-bar-item w3-button">로그아웃</a>
</div>

<div class="w3-container" style="margin-left:230px">
  <br><br>
  <h2><b>내 MBTI타입이 추천하는 채널</b>
    <button id="추가하기">
      <normal>+추가하기</normal>
    </button>
  </h2>
  <ul class="cards">
    <li>
      <div href="" class="card">
        <img src="https://i.imgur.com/oYiTqum.jpg" class="card__image" alt=""/>
        <div class="card__overlay">
          <div class="card__header">
            <svg class="card__arc" xmlns="http://www.w3.org/2000/svg">
              <path/>
            </svg>
            <img class="card__thumb" src="https://i.imgur.com/7D7I6dI.png" alt=""/>
            <div class="card__header-text">
              <h3 class="card__title">작성자 이름</h3>
               <nav class="level is-mobile">
                        <div class="level-left">
                            <div class="level-item is-sparta" aria-label="heart" onclick="toggle_like('', 'heart')">
                                <span class="icon is-small"><i class="fa fa-heart" aria-hidden="true"></i></span>&nbsp;<span class="like-num">2.7k</span>
                            </div>
                        </div>
               </nav>
            </div>
          </div>
          <p class="card__description">Lorem ipsum dolor sit amet consectetur adipisicing elit. Asperiores,
            blanditiis?</p>
          <button type="button" class="btn btn-outline-danger" id="삭제">삭제</button>
        </div>
      </a>
    </li>
    <li>
      <a href="" class="card">
        <img src="https://i.imgur.com/2DhmtJ4.jpg" class="card__image" alt=""/>
        <div class="card__overlay">
          <div class="card__header">
            <svg class="card__arc" xmlns="http://www.w3.org/2000/svg">
              <path/>
            </svg>
            <img class="card__thumb" src="https://i.imgur.com/sjLMNDM.png" alt=""/>
            <div class="card__header-text">
              <h3 class="card__title">작성자이름</h3>
               <nav class="level is-mobile">
                        <div class="level-left">
                            <div class="level-item is-sparta" aria-label="heart" onclick="toggle_like('', 'heart')">
                                <span class="icon is-small"><i class="fa fa-heart" aria-hidden="true"></i></span>&nbsp;<span class="like-num">2.7k</span>
                            </div>
                        </div>
               </nav>
            </div>
          </div>
          <p class="card__description">Lorem ipsum dolor sit amet consectetur adipisicing elit. Asperiores,
            blanditiis?</p>
          <button type="button" class="btn btn-outline-danger" id="삭제">삭제</button>
        </div>
      </a>
    </li>
    <li>
      <a href="" class="card">
        <img src="https://i.imgur.com/oYiTqum.jpg" class="card__image" alt=""/>
        <div class="card__overlay">
          <div class="card__header">
            <svg class="card__arc" xmlns="http://www.w3.org/2000/svg">
              <path/>
            </svg>
            <img class="card__thumb" src="https://i.imgur.com/7D7I6dI.png" alt=""/>
            <div class="card__header-text">
              <h3 class="card__title">Jessica Parker</h3>
               <nav class="level is-mobile">
                        <div class="level-left">
                            <div class="level-item is-sparta" aria-label="heart" onclick="toggle_like('', 'heart')">
                                <span class="icon is-small"><i class="fa fa-heart" aria-hidden="true"></i></span>&nbsp;<span class="like-num">2.7k</span>
                            </div>
                        </div>
               </nav>
            </div>
          </div>
          <p class="card__description">Lorem ipsum dolor sit amet consectetur adipisicing elit. Asperiores,
            blanditiis?</p>
          <button type="button" class="btn btn-outline-danger" id="삭제">삭제</button>
        </div>
      </a>
    </li>
    <li>
      <a href="" class="card">
        <img src="https://i.imgur.com/2DhmtJ4.jpg" class="card__image" alt=""/>
        <div class="card__overlay">
          <div class="card__header">
            <svg class="card__arc" xmlns="http://www.w3.org/2000/svg">
              <path/>
            </svg>
            <img class="card__thumb" src="https://i.imgur.com/sjLMNDM.png" alt=""/>
            <div class="card__header-text">
              <h3 class="card__title">kim Cattrall</h3>
               <nav class="level is-mobile">
                        <div class="level-left">
                            <div class="level-item is-sparta" aria-label="heart" onclick="toggle_like('', 'heart')">
                                <span class="icon is-small"><i class="fa fa-heart" aria-hidden="true"></i></span>&nbsp;<span class="like-num">2.7k</span>
                            </div>
                        </div>
               </nav>
            </div>
          </div>
          <p class="card__description">Lorem ipsum dolor sit amet consectetur adipisicing elit. Asperiores,
            blanditiis?</p>
          <button type="button" class="btn btn-outline-danger" id="삭제">삭제</button>
        </div>
      </a>
    </li>
  </ul>
</div>

</body>
</html>